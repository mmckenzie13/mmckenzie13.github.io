<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Project: Autopilot HWID Collection Script - mmckenzie13</title><meta name="description" content="Project Background I was on a project that involved collecting existing Windows 10 devices and getting them added into the Autopilot enrollment. The project though&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="./project-autopilot-hwid-collection-script.html"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:var(--body-font);--logo-font:var(--body-font);--menu-font:var(--body-font)}</style><link rel="stylesheet" href="./assets/css/style.css?v=9b8c2c950ce971bb347897f7e2550d3d"><link rel="stylesheet" href="./assets/css/prism-dark.css?v=4cc85e12ca94c0614c9359a37eb69a0c"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"./project-autopilot-hwid-collection-script.html"},"headline":"Project: Autopilot HWID Collection Script","datePublished":"2021-10-02T22:15","dateModified":"2021-10-02T22:15","description":"Project Background I was on a project that involved collecting existing Windows 10 devices and getting them added into the Autopilot enrollment. The project though&hellip;","author":{"@type":"Person","name":"Matt McKenzie"},"publisher":{"@type":"Organization","name":"Matt McKenzie"}}</script></head><body><header class="top"><div class="top__logo"><a class="logo" href="./">mmckenzie13</a></div><div class="top__search search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><svg class="search__icon" role="presentation" height="17" width="17"><use xlink:href="./assets/svg/svg-map.svg#search"/></svg><form action="./search.html" class="search__form" role="search"><input type="search" name="q" placeholder="Search documentation ..." aria-label="Search" class="search__input js-search-input"></form><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__button js-search-btn" aria-label="Search"><span>Search</span> <svg role="presentation" focusable="false" height="17" width="17"><use xlink:href="./assets/svg/svg-map.svg#search"/></svg></button></div><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button></header><main class="main"><div class="main__left"><div class="main__left-inner"><div class="main__left-content"><article class="post"><header><h1 class="post__title">Project: Autopilot HWID Collection Script</h1></header><div class="post__entry"><h2>Project Background</h2><p>I was on a project that involved collecting existing Windows 10 devices and getting them added into the Autopilot enrollment. The project though involved mutliple sites, no site to sites, and non domain joined workstations. </p><p>We had to figure out the best way to do a collection script for a team that was going on site to do site assessments / inventory. We created this script to be ran by them but could potentially be ran remotely via a screen share session. </p><p>You can find the repo for the script <a href="https://github.com/mmckenzie13/IntuneHWID">here. </a></p><h2>The Scripts</h2><p>1st script is a collection script (<a href="https://github.com/mmckenzie13/IntuneHWID/blob/main/HWID-EndUser.ps1" target="_blank" rel="noopener noreferrer">HWID-EndUser.pst1</a>). </p><ul><li>Serial Number of the Machine</li><li>Make a working directory</li><li>Collection Script download and run</li><li>Build CSV</li><li>Zip CSV</li><li>Try / Catch Statement for Sending via e-mail<ul><li>I gave a few different methods primarily using O365</li><li>I also gave a method to have the machine use the end users Outlook profile to create a new message and send the attachment</li></ul></li></ul><p>2nd script is the Admin script (<a href="https://github.com/mmckenzie13/IntuneHWID/blob/main/HWID-Admin.ps1" target="_blank" rel="noopener noreferrer">HWID-Admin.ps1</a>).</p><ul><li>Admin will need to create a HWIDZIP directory under C: to locate all of the ZIP files sent via e-mail. Easiest method is to drag and drop the zip from the e-mail into the folder for multiple e-mails</li><li>Run the script to have it unzip all of the compressed csv files into a directory and then combine all of the .CSVs into one master .CSV for the Autopilot provisioning page. </li></ul><p>This will make things a lot easier to manage since it is a process to upload a single .CSV<br>You can go back in to the CSV and open in Excel to add a new column for group and prepopulate it there as well. </p></div><footer><div class="post__footer-top"><div class="post__meta"><time datetime="2021-10-02T22:15">October 2, 2021 </time>by <a href="./authors/matt-mckenzie/" rel="author" title="Matt McKenzie">Matt McKenzie </a><span>Updated on: <time datetime="2021-10-02T22:15">October 2, 2021</time></span></div><div class="post__share"><button class="post__share-button js-post__share-button" aria-label="Share"><svg><use xlink:href="./assets/svg/svg-map.svg#share"></use></svg></button><div class="post__share-popup js-post__share-popup"></div></div></div><div class="post__footer-bottom"><ul class="post__tag"><li><a href="./tags/m365/">M365</a></li><li><a href="./tags/powershell/">Powershell</a></li></ul><div class="post__bio"><p><a href="./authors/matt-mckenzie/"><strong>Matt McKenzie</strong></a></p></div></div></footer></article><nav><ul class="posts-nav"><li class="posts-nav__prev"><span>Previous: </span><a href="./project-zip-files-name-date-sftp-upload.html" class="invert" rel="prev" title="Project: Zip Files, Name, Date, SFTP Upload">Project: Zip Files, Name, Date, SFTP Upload</a></li></ul></nav></div><aside class="main__left-aside"><div class="main__left-aside__inner"><h3>On this page</h3><nav class="aside-toc" id="aside-toc"></nav></div></aside></div></div><div class="main__right"><div class="main__right-inner"><nav class="navbar"><ul class="navbar__menu"><li class="has-submenu"><a href="./" target="_blank" aria-haspopup="true">Home</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://mattmckenzie.co" target="_blank">About Me</a></li><li><a href="https://github.com/mmckenzie13" target="_blank">Github</a></li></ul></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">Projects</span><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="./tags/powershell/" target="_blank">Powershell</a></li><li><a href="./tags/m365/" target="_self">Microsoft 365</a></li></ul></li></ul></nav><div class="footer main__right-footer"><div class="footer__copy">Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener">Publii</a></div></div></div></div></main><footer class="footer"><div class="footer__wrap"><div class="footer__inner"><div class="footer__copy">Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener">Publii</a></div></div></div></footer><div class="post__progress" id="js-post__progress" aria-hidden="true"></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',        
        submenuWidth: 300,        
        mobileMenuExpandableSubmenus: true,
        isHoverMenu: false,
        ariaButtonAttribute: 'aria-expanded',
   };</script><script src="./assets/js/html-contents.min.js?v=169077c370ab8ca62b029845f80f7fd5" defer="defer"></script><script>document.addEventListener("DOMContentLoaded", function(event) {
            htmlContents('#aside-toc', {
                area: '.post__entry',
                top: 2,
                bottom: 3,
                listType: 'o',
                filter: function(arr) {
                    return !arr.matches('.noOutline')
                },
                addIds: true,
                addLinks: true
            });

            setTimeout(function() {
                handleActiveClass('#aside-toc');
            }, 0);
        })</script><script defer="defer" src="./assets/js/scripts.min.js?v=2e5cce97094c516b8f7e6af7e7cd3e09"></script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="./assets/js/prism.js?v=277309e26a038bf312a7e8aa239cfbd8"></script><script defer="defer" src="./assets/js/prism-line-numbers.min.js?v=13275d3ac10d7028cf6a6f5da276f68c"></script><script defer="defer" src="./assets/js/prism-copy-to-clipboard.min.js?v=fabfc3fd9af83cda5208ba2e9f9ed238"></script></body></html>